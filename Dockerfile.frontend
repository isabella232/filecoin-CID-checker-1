FROM node:12 as builder

WORKDIR /app/

COPY ./ /app/

RUN yarn install

ARG REACT_APP_FILECOIN_CID_CHECKER_API
ENV REACT_APP_FILECOIN_CID_CHECKER_API /api

WORKDIR /app/packages/frontend

RUN yarn run build && env

FROM nginx:1.21.4-alpine

COPY --from=builder /app/packages/frontend/build /usr/share/nginx/html

COPY 502.html /usr/share/nginx/html/not_in_maintenance.html

COPY nginx.conf mime.types /etc/nginx/
